!function(a,b,c){var d,e,f,require,g,h;return d={},f={},f.use=function(a,b){var c,e,f,g,h,i,j;for(c=[],h=g=0,i=a.length;i>g;h=++g){if(f=a[h],j=d[f],!j)throw{name:"module not define",message:mod+"\u6a21\u5757\u672a\u5b9a\u4e49"};e=require(f),c.push(e)}return b?b.apply(this,c):void 0},h={},f.later=function(b,c,d){var e;if(!h[d])return e=Array.prototype.slice.apply(arguments,[3]),h[d]=a.setTimeout(function(b){return function(){return c.apply(b,e),a.clearTimeout(h[d]),h[d]=null}}(this),b)},f.define=function(a,b){var c;if(c={},c.func=b,c.reback=-99999,d[a])throw{name:"module has defined",message:a+"\u6a21\u5757\u5df2\u7ecf\u5b9a\u4e49\u8fc7"};return d[a]=c},f.clone=function(a){return laputa.$.extend(!0,{},a)},f.getParam=function(a,b){var c,d;return b||(b=window.location.href),a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),c=new RegExp("[\\?&]"+a+"=([^&#]*)"),d=c.exec(b),null===d?null:decodeURIComponent(d[1].replace(/\+/g," "))},a.koo=f,e={},g=1,require=function(a){var b;if(b=d[a],!b)throw{name:"module not define",message:a+"\u6a21\u5757\u672a\u5b9a\u4e49"};return-99999!==b.reback?b.reback:e[a]?(f.later(g,require,"initReuire",a),g++,b.reback):(e[a]=!0,b.reback=b.func(require),e={},g=1,b.reback)}}(this,document);var laputa;laputa={},laputa.models={},laputa.views={},laputa.data={},laputa.ids={},window.KISSY?laputa.$=jQuery.noConflict(!0):laputa.$=$,laputa.funcs=[],laputa.on=function(a){return laputa.funcs.push(a)};var bind=function(a,b){return function(){return a.apply(b,arguments)}};koo.define("laputa/board",function(require){var a;return a=function(){function a(){this.addItem=bind(this.addItem,this),this.start=bind(this.start,this),this.itemMove=bind(this.itemMove,this),this.itemSize=bind(this.itemSize,this),this.bindDragAndResize=bind(this.bindDragAndResize,this)}return a.prototype.getAutoId=function(){return this.data.counter++,this.data.counter},a.prototype.init=function(a){var b;return this._init_(a),b=laputa.$('<div class="laputa-tool">\n  <span class="laputa-btn save">\u4fdd\u5b58</span>\n  <label for="J_laputaFile" data-id="'+a+'" class="laputa-btn upload">\u4e0a\u4f20\u56fe\u7247</label>\n</div>'),laputa.$(".save",b).click(function(a){return function(){var b;return laputa.data[a.data.id]=a.data,b=require("laputa/save"),b.submit()}}(this)),laputa.$(".upload",b).click(function(a){return laputa.uploadDom=laputa.$(a.currentTarget)}),this.element.append(b)},a.prototype.poster=function(a){return this._init_(a),laputa.$("#J_upload").click(function(a){return laputa.uploadDom=laputa.$(a.currentTarget)}),laputa.$("#J_save").click(function(a){return function(){var b;return laputa.data[a.data.id]=a.data,b=require("laputa/save"),b.submit()}}(this))},a.prototype._init_=function(a){var b,c,d,e,f,g,h,i,j,k,l;if(this.data=laputa.data[a],this.element=laputa.$("#"+a),this.data){for(e="",k=this.data.imgs,c=0,i=k.length;i>c;c++)d=k[c],e+='<img src="'+d+'" />';for(e.length>1&&this.element.html(e),g="",l=this.data.items,h=0,j=l.length;j>h;h++)f=l[h],g+='  <a target="_blank" data-i="'+f.id+'" style="height: '+f.height+";width: "+f.width+";top: "+f.top+";left: "+f.left+';" href="'+f.url+'">\n   <span class="remove"></span>\n</a>';g.length>1&&this.element.append(g)}else this.data={type:"board",id:a,width:0,height:0,counter:0,imgs:[],style:{},items:[]};return this.element.addClass("edit"),this.element.delegate("a","dblclick",function(a){return function(b){var c,d,e,g;return b.preventDefault(),d=laputa.$(b.currentTarget),a.currentId=d.data("i"),a.currentElement=d,e=d.attr("href"),g='<dl class="rain-left"><dt>\u94fe\u63a5\u5730\u5740</dt><dd><input type="text" name="url" value="'+e+'"></dd></dl>',c=function(a,b){var c;return c=laputa.$("input[name='url']",a),f=this.getItem(),f.url=c.val(),this.currentElement.attr("href",f.url),b.remove()},koo.dialog("\u7f16\u8f91\u94fe\u63a5",g,c,a)}}(this)),this.element.delegate("a","click",function(a){return a.preventDefault()}),this.element.delegate(".remove","click",function(b){return function(c){var d,e;return d=function(){var a,b,c,d;for(this.currentElement.remove(),d=this.data.items,a=b=0,c=d.length;c>b;a=++b)if(f=d[a],f.id===this.currentId)return this.data.items.splice(a,1)},e=laputa.$(c.currentTarget).parent(),b.currentId=e.data("i"),b.currentElement=e,koo.confirm("\u786e\u5b9a\u5220\u9664\u5417\uff1f",d,b),c.stopPropagation(),c.preventDefault(),a=laputa.$(c.currentTarget).parent().data("i")}}(this)),this.element.selectable({start:this.start,stop:this.addItem,cancel:"a,.laputa-btn"}),b=laputa.$("a",this.element),this.bindDragAndResize(b)},a.prototype.bindDragAndResize=function(a){return a.draggable({stop:this.itemMove}).css("position","absolute"),a.resizable({minHeight:45,minWidth:45,resize:this.itemSize})},a.prototype.getItem=function(a){var b,c,d,e;for(a||(a=this.currentId),e=this.data.items,b=0,d=e.length;d>b;b++)if(c=e[b],c.id===a)return c},a.prototype.getOffset=function(a){var b,c,d,e;return e=a.target,void 0===e.offsetLeft&&(e=e.parentNode),d=getPageCoord(e),b={x:window.pageXOffset+a.clientX,y:window.pageYOffset+a.clientY},c={offsetX:b.x-d.x,offsetY:b.y-d.y}},a.prototype.getPageCoord=function(a){var b;for(b={x:0,y:0};a;)b.x+=a.offsetLeft,b.y+=a.offsetTop,a=a.offsetParent;return b},a.prototype.itemSize=function(a,b){var c,d,e;return e=laputa.$(a.target),c=e.data("i"),d=this.getItem(c),d.width=b.size.width+"px",d.height=b.size.height+"px"},a.prototype.itemMove=function(a,b){var c,d,e,f,g;return f=laputa.$(a.target),c=f.data("i"),e=this.getItem(c),g=b.position.top,d=b.position.left,e.top=g+"px",e.left=d+"px"},a.prototype.start=function(a,b){return this.startEv=a},a.prototype.getItemDom=function(a){var b;return b=laputa.$('<a target="_blank" data-i="'+a.id+'" style="height: '+a.height+";width: "+a.width+";top: "+a.top+";left: "+a.left+';" href="'+a.url+'">\n   <span class="remove"></span>\n</a>')},a.prototype.addItem=function(a,b){var c,d,e,f,g,h,i,j;return a.preventDefault(),a.stopPropagation(),h=laputa.$(a.target),e=h.attr("id"),j=a.pageX-this.startEv.pageX,d=a.pageY-this.startEv.pageY,Math.abs(j)<16||Math.abs(d)<16?void 0:(void 0===this.startEv.offsetX&&(this.startEv=getOffset(startEv)),i=this.startEv.offsetY,g=this.startEv.offsetX,0>j&&(g+=j),0>d&&(i+=d),j=Math.abs(j),d=Math.abs(d),f={},f.id=this.getAutoId(),f.url="",f.width=j+"px",f.height=d+"px",f.top=i+"px",f.left=g+"px",this.data.items.push(f),c=this.getItemDom(f),this.element.append(c),this.bindDragAndResize(c))},a}()}),function(){var a;return a={},a.target=null,a.init=function(){},a.id="id"+parseInt(1e4*Math.random())+(new Date).getMilliseconds(),a.maskDiv=function(b,c,d,e){var f;return f='<div class="laputa-dialog" id="'+a.id+'">\n  <div class="laputa-bg"></div>\n  <div class="window">\n    <div class="head">\n      <span>'+b+'</span><em class="bbs-icon close"></em>\n    </div>\n    <div class="body">\n      <div class="content">'+c+'</div>\n    </div>\n    <div class="foot">'+d+"</div>\n  </div>\n</div>",a.target&&a.target.remove(),laputa.$("body").append(f),a.target=laputa.$("#"+a.id),laputa.$(".window",a.target).jqDrag(".head"),laputa.$(".close",a.target).on("click",function(b){return a.remove()})},a.remove=function(){return a.target?a.target.remove():void 0},koo.alert=function(b){return a.maskDiv("\u7cfb\u7edf\u63d0\u793a",b,'<span class="laputa-btn close">\u5173\u95ed</span>')},koo.confirm=function(b,c,d){return"function"!=typeof c?alert("\u56de\u8c03\u51fd\u6570\u9519\u8bef"):(a.maskDiv("\u7cfb\u7edf\u63d0\u793a",b,'<span class="laputa-btn confirm">\u786e\u8ba4</span><span class="laputa-btn close">\u53d6\u6d88</span>',c),laputa.$(".confirm",a.target).on("click",function(){return d?c.call(d,!0):c(!0),a.remove()}))},koo.dialog=function(b,c,d,e){var f;return f='<span class="laputa-btn confirm">\u786e\u8ba4</span>\n<span class="laputa-btn close">\u5173\u95ed</span>',a.maskDiv(b,c,f,d),a.target.addClass("dialog"),laputa.$(".confirm",a.target).on("click",function(b){return d.call(e,a.target,a)}),a.target}}.call(this),koo.define("laputa/form",function(require){var a;return new(a=function(){function a(){}return a.prototype.init=function(a,b){var c,d,e,f;if(this.model=a,this.data=b,this.loadForm(),!this.data){if(1!==this.model.min&&this.model.min){for(c=[],d=e=0,f=this.model.min;f>=0?f>e:e>f;d=f>=0?++e:--e)c.push(koo.clone(this.model.test));return this.data=c}return this.data=koo.clone(this.model.test)}},a.prototype.initBlock=function(a,b){return this.model=a,this.data=b.data,this.isBlock=!0,this.init(this.model,this.data),this.render()},a.prototype.render=function(){var a,b,c,d;if(d="",void 0===this.data.length)d=this.renderItem(this.data);else for(a=b=0,c=this.data.length;c>=0?c>b:b>c;a=c>=0?++b:--b)d+=this.renderItem(this.data[a],a);return laputa.$(".laputa-modal-content",this.laputaDom).html(d),laputa.$("body").css("overflow","hidden"),laputa.$(".laputa-lbl",this.laputaDom).click(function(a){return laputa.uploadDom=laputa.$(a.currentTarget)}),this.laputaDom.show()},a.prototype.addItem=function(a){var b,c,d,e,f;return f=a.parents(".laputa-item"),d=parseInt(f.data("index")),c=laputa.data[this.model.name].data,c.length>=this.model.max?this.tip("\u4e0d\u80fd\u8d85\u8fc7"+this.model.max+"\u6761\u6570\u636e"):(b=laputa.$(".laputa-modal-content",this.laputaDom),b[0].scrollHeight&&(b[0].scrollTop=b[0].scrollHeight),e=koo.clone(this.model.test),c.splice(d+1,0,e),this.render())},a.prototype.removeItem=function(a){var b,c,d;return d=a.parents(".laputa-item"),c=parseInt(d.data("index")),b=laputa.data[this.model.name].data,b.length<=this.model.min||1===b.length?this.tip("\u81f3\u5c11\u8981\u6709"+this.model.min+"\u6761\u6570\u636e"):(b.splice(c,1),this.render())},a.prototype.renderItem=function(a,b){var c,d;return void 0===b&&(b=""),d=this.single(a),c="",this.model.max&&this.model.max>this.model.min&&(c='<div>\n    <span title="\u5220\u9664\u5f53\u524d\u7eaa\u5f55" class="laputa-delete"></span>\n    <span title="\u6dfb\u52a0\u4e00\u6761\u6570\u636e" class="laputa-add"></span>\n</div>'),d='<div class="laputa-item" data-index="'+b+'">\n    <div class="laputa-title">\n        '+this.model.title+" "+(b+1)+" "+c+"\n    </div>\n    "+d+"\n</div>"},a.prototype.tip=function(a){var b;return b=laputa.$(".J_laputaTip",this.laputaDom),b.text(a),b.show(),koo.later(6e3,function(){return b.hide()},"J_laputaTip")},a.prototype.single=function(a){var b,c,d,e,f,g,h,i,j;if(a&&"object"==typeof a){j="",e=this.model.proto;for(c in e){if(i=e[c],b=[],h=a[c],void 0===h&&(h=""),i?b=i.split(":"):b[0]="",f="",d=b[0].split("-"),g=d[0],d.length>1&&(f="<strong>"+d[1]+"</strong>"),1===b.length)b[1]="";else{if("bool"===b[1]){j+="<li><span>"+g+'</span><input type="checkbox" value="true" name="'+c+'" koo="'+h+'" />'+f+"</li>";continue}b[1]=' koo="'+b[1]+'" '}j+=b[1].indexOf("pic")>0?"<li><span>"+g+'</span><input type="text" value="'+h+'" class="mid" name="'+c+'" '+b[1]+' /><label for="J_laputaFile" class="laputa-lbl" target="'+c+'">\u4e0a\u4f20</label>'+f+"</li>":"<li><span>"+g+'</span><input type="text" value="'+h+'" name="'+c+'" '+b[1]+" />"+f+"</li>"}return j='<ul class="rain-left">\n  '+j+"\n</ul>"}},a.prototype.getData=function(a){return a.data&&a.data.length>0?a.data:a},a.prototype.loadForm=function(){var a,b,c;return this.laputaDom=laputa.$("#J_laputaEditor"),this.laputaDom.length>0?(laputa.$(".J_laputaSave",this.laputaDom).data("id",this.model.name),laputa.$("h4",this.laputaDom).text(this.model.title)):(c='<div class="laputa-form" id="J_laputaEditor">\n    <div class="laputa-bg"></div>\n    <div class="laputa-modal">\n        <h4>'+this.model.title+'</h4>\n        <span class="laputa-close"></span>\n        <div class="laputa-modal-content"></div>\n        <div class="laputa-modal-foot">\n          <span class="J_laputaSave", data-id = "'+this.model.name+'">\u4fdd\u5b58</span>\n          <div class="J_laputaTip"></div>\n        </div>\n    </div>\n</div>',this.laputaDom=laputa.$(c),laputa.$(".laputa-close,.J_laputaSave",this.laputaDom).click(function(){return laputa.$("body").css("overflow","auto"),laputa.$("#J_laputaEditor").hide()}),this.laputaDom.delegate("span","click",function(a){return function(b){var c;return c=laputa.$(b.currentTarget),c.hasClass("laputa-delete")?a.removeItem(c):c.hasClass("laputa-add")?a.addItem(c):void 0}}(this)),b=this,this.laputaDom.delegate("input","change",function(a){var c,d,e,f,g,h,i;return h=laputa.$(a.currentTarget),d=parseInt(h.parents(".laputa-item").data("index")),f=b.model.name,c=laputa.data[f],e=b.getData(c),i=h.val(),g=h.attr("name"),e?isNaN(d)?e[g]=i:e[d][g]=i:isNaN(d)?(e={},e[g]=i):(e[d]={},e[d][g]=i)}),a=function(a,b){return laputa.$("input",b).each(function(){var b,c,d,e,f;return d=laputa.$(this),b=d.attr("name"),f=d.val(),e=d.attr("type"),"checkbox"===e&&(f=d.prop("checked")?!0:!1,f=d.prop("checked")),c=b.split("."),c.length>1?a[c[0]][c[1]]=f:a[b]=f})},laputa.$(".J_laputaSave",this.laputaDom).click(function(){var c,d,e,f,g,h,i,j,k,l;if(i=b.model.name,c=laputa.data[i],h=laputa.models[i],f=laputa.$(".laputa-item",b.laputaDom),1!==f.length||h.max)for(d=g=0,j=f.length;j>=0?j>g:g>j;d=j>=0?++g:--g)e=b.getData(c),a(e,f[d]);else a(c,f);return b.isBlock||(k=require("laputa/render"),k.update(i)),l=require("laputa/save"),l.submit()}),laputa.$("body").append(this.laputaDom))},a}())}),koo.define("laputa/parse",function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n;for(n=laputa.$("script"),m=[],f=0,h=n.length;h>f;f++)if(e=n[f],b=laputa.$(e),j=b.attr("model"),j&&(k=laputa.$("#"+j).html())){try{i=laputa.$.parseJSON(k),i.name=j}catch(o){c=o,alert(j+" \u539f\u578b\u683c\u5f0f\u9519\u8bef")}if(laputa.models[j]=i,"text/html"===b.attr("type")&&i&&(laputa.views[j]=b),i.max||i.min&&!(i.min<2)){for(a=[],d=g=0,l=i.min;l>=0?l>g:g>l;d=l>=0?++g:--g)a.push(koo.clone(i.test));m.push(laputa.data[j]={data:a})}else m.push(laputa.data[j]=i.test)}return m}),koo.define("laputa/render",function(require){var a;return a={},a.init=function(){var b,c,d,e,f;e=laputa.views,f=[];for(d in e)c=e[d],b=laputa.data[d],f.push(a.render(c,b,d));return f},a.update=function(b){var c,d;return laputa.$(".J_laputa"+b).remove(),d=laputa.views[b],c=laputa.data[b],a.render(d,c,b)},a.render=function(a,b,c){var d,e,f,g,h;try{h=a.html(),f=template.compile(h,{filename:c}),g=f(b),d=laputa.$(g),a.before(d)}catch(i){e=i,alert(c+"\u6a21\u7248\u8bed\u6cd5\u9519\u8bef")}return laputa.models[c].readOnly||(d.addClass("J_laputa"+c),d.addClass("laputa-outer"),d.data("modalId",c),d.click(function(a){var c,d,e,f;return f=laputa.$(a.currentTarget).data("modalId"),e=laputa.models[f],b=laputa.data[f],c=b.data?b.data:b,d=require("laputa/form"),d.init(e,c),d.render()})),laputa.renderFinish&&laputa.$("body").delegate("a","click",function(a){var b,c;return c=laputa.$(a.currentTarget),c.hasClass("lp-i")||(b=c.parents(".lp-i"),b.length>0)?void 0:a.preventDefault()}),laputa.renderFinish=!0},a}),koo.define("laputa/save",function(){var a,b;return a='{{each imgs as img}}\n    <img src="{{img}}" alt="" />\n{{/each}}\n{{each items as item}}\n    <a target="_blank" style="height:{{item.height}};width:{{item.width}};left:{{item.left}};top:{{item.top}}" href="{{item.url}}"></a>\n{{/each}}',b={},b.submit=function(){var b,c,d,e,f,g,h,i,j,k,l,m;j={},l=null,b=0,e=!1,h=laputa.data;for(f in h){if(d=h[f],"board"===d.type)k=a;else{if(m=laputa.views[f],!m)continue;k=1===m.length?m.html():m}template.onerror=function(a){var b,c,d;for(e=!0,alert(f+"\u6a21\u7248\u6709\u8bed\u6cd5\u9519\u8bef\uff0c\u4e0d\u80fd\u4fdd\u5b58"),d="Template Error\n\n",b=0,c=a.length;c>b;b++)f=a[b],d+="<"+f+">\n"+a[f]+"\n\n";return"object"==typeof console,void 0},i=template.compile(k),l=i(d),j[f]=l,b++}return e?void 0:(c={},c.data=JSON.stringify(laputa.data),1===b&&"block"===laputa.type?c.result=l:c.result=JSON.stringify(j),c._tb_token_=laputa.$("#J_token").val(),laputa.blockName&&(c.blockName=laputa.blockName),laputa.postId&&(c.postId=laputa.postId,laputa.$.ajax({url:"/admin/json/addOrUpdateAlbum.do",data:c,type:"POST",dataType:"json",success:function(a){return a.success?void 0:alert(a.msg)}})),laputa.pageName&&(c.pageName=laputa.pageName),g=koo.getParam("protoId"),g&&(c.protoId=g,c.postId=laputa.pageName),laputa.$.ajax({url:"/admin/json/addOrUpdateData.do",data:c,type:"POST",dataType:"json",success:function(a){return a.success&&(a.msg="\u4fdd\u5b58\u6210\u529f"),alert(a.msg)}}))},b}),function(){return laputa.$(document).ready(function(){var a;return laputa.$("body").append('<div id="J_laputaProccess">\u4e0a\u4f20\u8fdb\u5ea6\uff1a<span></span>%\n      <input type="file" style="display: none;" name="file" id="J_laputaFile">\n    </div>'),a={},laputa.$(document).on("change","#J_laputaFile",function(b){var c,d,e,f,g,h;return a.dom=laputa.$("#J_laputaProccess span"),(g=laputa.$(this).val())?(null!==a.timer&&(clearInterval(a.timer),a.start=0),e=function(b){return"finish"===b?(a.dom.text("100"),clearInterval(a.timer),a.timer=null,a.start=0,alert("\u4e0a\u4f20\u6210\u529f"),a.dom.parent().hide()):(a.start+=2,a.start>100&&(alert("\u670d\u52a1\u5668\u7aef\u5904\u7406\u8d85\u65f6\uff0c\u8bf7\u91cd\u65b0\u4e0a\u4f20"),clearInterval(a.timer),a.timer=null,a.dom.text("1"),a.dom.parent().hide()),a.start>70?void 0:a.dom.text(a.start))},a.timer=setInterval(e,500),c=document.getElementById("J_laputaFile"),f="/json/file_upload_action/upload_image.json",laputa.uploadDom.hasClass("upload")&&(f="/json/fileUploadJson.do"),a.dom.parent().show(),h=new XMLHttpRequest,h.onreadystatechange=function(){var a,b,d,f,i,j,k,l;if(4===h.readyState&&(c.value="",200===h.status)){if(k=h.responseText,l=laputa.$.parseJSON(k),!l.success)return alert(l.msg);if(laputa.uploadDom.hasClass("laputa-lbl"))d=koo.cleanHttp(l.url),i=laputa.uploadDom.prev(),i.val(d),i.trigger("change");else{b=laputa.uploadDom.data("id"),a=laputa.data[b],j=l.map;for(f in j)g=j[f],"0"===f&&(a.width=g.width),d=koo.cleanHttp(g.url),a.imgs.push(d)}return e("finish")}},d=new window.FormData,d.append("_tb_token_",laputa.$("#J_token").val()),d.append("type","ajax"),d.append("auto",!0),c.files[0]?(d.append("file",c.files[0]),h.open("POST",f,!0),h.send(d)):alert("\u8bf7\u5148\u9009\u62e9\u6587\u4ef6")):void 0})})}.call(this),koo.cleanHttp=function(a){var b,c;return c=laputa.$.trim(a),-1!==c.indexOf("http")&&(b=c.split(":"),b.length>1&&(c=b[1])),c},koo.define("laputa/validate",function(){var a;return new(a=function(){function a(){}return a.prototype.init=function(a){return void 0},a.prototype.bindEvent=function(){},a.prototype.check=function(){},a}())}),laputa.loadPage=function(a){return laputa.loaded?void 0:(laputa.loaded=!0,laputa.postId=koo.getParam("postId"),laputa.pageName=koo.getParam("pageName"),laputa.type="page",koo.use(["laputa/render","laputa/board","laputa/parse"],function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o;if(f={},f.pageName=laputa.pageName,f.postId=laputa.postId,o="",laputa.postId&&(o="/admin/json/getPageData.do?postId="+laputa.postId),laputa.pageName&&(o="/admin/json/getPrototypePageData.do?pageName="+laputa.pageName),o)return laputa.$.ajax({url:o,dataType:"json",type:"GET",success:function(i){var j,k,l,n,o,p,q,r,s;if(j=koo.getParam("_reset"),i&&i.data&&!j){f=laputa.$.parseJSON(i.data);for(k in f)s=f[k],laputa.data[k]=s}for(q=laputa.funcs,l=0,n=q.length;n>l;l++)g=q[l],g.call(window);if(a)return m=new c,m.poster("posterContent");if(b.init(),e=laputa.$(".J_laputaBoard"),!(e.length<0)){for(r=[],p=0,o=e.length;o>p;p++)d=e[p],h=laputa.$(d).attr("id"),h?(m=new c,r.push(m.init(h))):alert("\u81ea\u5b9a\u4e49\u533a\u5fc5\u987b\u8981\u6709Id");return r}}});if(laputa.readOnly=!0,a)return m=new c,m.poster("posterContent");if(b.init(),e=laputa.$(".J_laputaBoard"),!(e.length<0)){for(i=0,k=e.length;k>i;i++)d=e[i],h=laputa.$(d).attr("id"),h?(m=new c,m.init(h)):alert("\u81ea\u5b9a\u4e49\u533a\u5fc5\u987b\u8981\u6709Id");for(n=laputa.funcs,j=0,l=n.length;l>j;j++)g=n[j],g.call(window)}}))},laputa.edit=function(a){var b,c;return b=window.event,b||(b=arguments.callee.caller.arguments[0]),laputa.type="block",b.preventDefault(),b.stopPropagation?b.stopPropagation():b.cancelBubble=!0,laputa.data={},c=$(b.currentTarget),laputa.blockName=a,koo.use(["laputa/form"],function(b){var d;return d={},d.name=a,laputa.$.ajax({url:c.attr("href"),data:d,dataType:"json",type:"GET",success:function(a){return laputa.$.ajax({dataType:"json",url:c.attr("blockHref"),data:d,type:"GET",success:function(c){var d,e,f,g,h,i,j,k,l;j=c.name,g=koo.getParam("_reset"),a&&a.data&&!g&&(e=laputa.$.parseJSON(a.data),d=e[j]);try{i=laputa.$.parseJSON(c.description)}catch(m){alert(j+"\u63cf\u8ff0\u5bf9\u8c61\u9519\u8bef")}if(!i||!i.test)return alert("\u672a\u5b9a\u4e49\u533a\u5757\u6a21\u578b");if(i.name=j,laputa.models[j]=i,laputa.views[j]=c.code,!d)if(i.min>0){for(l=[],f=h=0,k=i.min;k>=0?k>h:h>k;f=k>=0?++h:--h)l.push(koo.clone(i.test));d||(d={}),d.data=l}else d=i.test;return laputa.data[j]=d,b.initBlock(i,d)}})}})})},laputa.$(document).ready(function(){return laputa.loadPage()});